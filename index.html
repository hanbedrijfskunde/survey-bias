<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Survey Bias Quiz - Enhanced</title>
		<style>
			/* --- Root Variables for Easy Theming --- */
			:root {
				--primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				--secondary-gradient: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
				--action-gradient: linear-gradient(145deg, #9b59b6, #8e44ad);
				--correct-gradient: linear-gradient(145deg, #2ecc71, #27ae60);
				--incorrect-gradient: linear-gradient(145deg, #e74c3c, #c0392b);

				--bg-light: #f8f9fa;
				--bg-white: #ffffff;
				--border-color: #dee2e6;
				--text-dark: #2c3e50;
				--text-medium: #495057;
				--text-light: #666;

				--border-radius-main: 16px;
				--border-radius-inner: 12px;
				--shadow-main: 0 8px 32px rgba(0, 0, 0, 0.15);
				--shadow-hover: 0 6px 20px rgba(79, 172, 254, 0.4);
			}

			* {
				box-sizing: border-box;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
					Helvetica, Arial, sans-serif;
				background: var(--primary-gradient);
				color: var(--text-dark);
				display: flex;
				justify-content: center;
				align-items: center;
				min-height: 100vh;
				margin: 0;
				padding: 20px;
			}

			#quiz-container {
				background-color: var(--bg-white);
				border-radius: var(--border-radius-main);
				box-shadow: var(--shadow-main);
				width: 100%;
				max-width: 900px;
				padding: 40px;
				position: relative;
				overflow: hidden;
				transition: all 0.3s ease;
			}

			.progress-container {
				width: 100%;
				height: 6px;
				background-color: #e0e0e0;
				border-radius: 3px;
				margin-bottom: 30px;
				overflow: hidden;
			}

			.progress-bar {
				height: 100%;
				background: var(--secondary-gradient);
				width: 0%;
				border-radius: 3px;
				transition: width 0.6s ease;
			}

			.progress-text {
				text-align: center;
				font-size: 0.9em;
				color: var(--text-light);
				margin-bottom: 20px;
			}

			.question-header {
				text-align: center;
				margin-bottom: 30px;
				font-size: 1.8em;
				font-weight: 700;
				color: var(--text-dark);
				opacity: 0;
				animation: slideIn 0.6s ease forwards;
			}

			@keyframes slideIn {
				from {
					opacity: 0;
					transform: translateY(-20px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			.question-pair {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 25px;
				margin-bottom: 30px;
				border-top: 2px solid #e8ecf4;
				border-bottom: 2px solid #e8ecf4;
				padding: 25px 0;
				opacity: 0;
				animation: slideIn 0.6s ease 0.2s forwards;
			}

			@media (max-width: 768px) {
				.question-pair {
					grid-template-columns: 1fr;
					gap: 20px;
				}
			}

			.question-box {
				padding: 20px;
				border-radius: var(--border-radius-inner);
				background: linear-gradient(145deg, var(--bg-light), #e9ecef);
				border: 1px solid var(--border-color);
				position: relative;
				transition: transform 0.2s ease, box-shadow 0.2s ease;
			}

			.question-box:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
			}

			.question-box h3 {
				margin-top: 0;
				margin-bottom: 15px;
				color: var(--text-medium);
				font-size: 1.1em;
				font-weight: 600;
			}

			.question-box.biased h3 {
				color: #e74c3c;
			}
			.question-box.improved h3 {
				color: #27ae60;
			}

			.question-box p {
				font-style: italic;
				line-height: 1.6;
				margin: 0;
				font-size: 0.95em;
			}

			.quiz-question {
				text-align: center;
				font-size: 1.3em;
				font-weight: 600;
				color: var(--text-dark);
				margin-bottom: 25px;
				opacity: 0;
				animation: slideIn 0.6s ease 0.4s forwards;
			}

			#options-container {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
				gap: 15px;
				margin-bottom: 25px;
				opacity: 0;
				animation: slideIn 0.6s ease 0.6s forwards;
			}

			.option-btn {
				background: var(--secondary-gradient);
				color: white;
				border: none;
				padding: 18px 20px;
				border-radius: var(--border-radius-inner);
				font-size: 1em;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.3s ease;
				position: relative;
				overflow: hidden;
				transform: translateY(0);
			}

			.option-btn::before {
				content: "";
				position: absolute;
				top: 0;
				left: -100%;
				width: 100%;
				height: 100%;
				background: linear-gradient(
					90deg,
					transparent,
					rgba(255, 255, 255, 0.2),
					transparent
				);
				transition: left 0.5s;
			}

			.option-btn:hover:not(:disabled) {
				transform: translateY(-3px);
				box-shadow: var(--shadow-hover);
			}

			.option-btn:hover:not(:disabled)::before {
				left: 100%;
			}
			.option-btn:active {
				transform: translateY(-1px);
			}
			.option-btn:disabled {
				cursor: not-allowed;
				opacity: 0.8;
			}
			.option-btn.correct {
				background: var(--correct-gradient);
				animation: pulse 0.6s ease;
			}
			.option-btn.incorrect {
				background: var(--incorrect-gradient);
				animation: shake 0.6s ease;
			}

			@keyframes pulse {
				0%,
				100% {
					transform: scale(1);
				}
				50% {
					transform: scale(1.05);
				}
			}
			@keyframes shake {
				0%,
				100% {
					transform: translateX(0);
				}
				25% {
					transform: translateX(-5px);
				}
				75% {
					transform: translateX(5px);
				}
			}

			#feedback-container {
				padding: 20px;
				border-radius: var(--border-radius-inner);
				margin-top: 25px;
				line-height: 1.7;
				font-size: 1.05em;
				opacity: 0;
				transform: translateY(20px);
				transition: all 0.4s ease;
			}
			#feedback-container.show {
				opacity: 1;
				transform: translateY(0);
			}
			.feedback-correct {
				background: linear-gradient(145deg, #d4edda, #c3e6cb);
				border-left: 5px solid #28a745;
				color: #155724;
			}
			.feedback-incorrect {
				background: linear-gradient(145deg, #f8d7da, #f1b2b2);
				border-left: 5px solid #dc3545;
				color: #721c24;
			}

			#next-btn,
			#restart-btn,
			#download-btn {
				display: block;
				width: 100%;
				padding: 18px;
				background: var(--action-gradient);
				color: white;
				border: none;
				border-radius: var(--border-radius-inner);
				font-size: 1.2em;
				font-weight: 600;
				cursor: pointer;
				margin-top: 25px;
				transition: all 0.3s ease;
				position: relative;
				overflow: hidden;
			}
			#next-btn::before,
			#restart-btn::before,
			#download-btn::before {
				content: "";
				position: absolute;
				top: 0;
				left: -100%;
				width: 100%;
				height: 100%;
				background: linear-gradient(
					90deg,
					transparent,
					rgba(255, 255, 255, 0.2),
					transparent
				);
				transition: left 0.5s;
			}
			#next-btn:hover,
			#restart-btn:hover,
			#download-btn:hover {
				transform: translateY(-2px);
				box-shadow: 0 6px 20px rgba(155, 89, 182, 0.4);
			}
			#next-btn:hover::before,
			#restart-btn:hover::before,
			#download-btn:hover::before {
				left: 100%;
			}

			.hidden {
				display: none !important;
			}

			#results-container {
				text-align: center;
				opacity: 0;
				animation: slideIn 0.6s ease forwards;
			}
			#results-container h2 {
				color: var(--text-dark);
				font-size: 2.2em;
				margin-bottom: 20px;
				font-weight: 700;
			}

			.score-display {
				font-size: 3em;
				font-weight: 700;
				margin: 20px 0;
				background: var(--secondary-gradient);
				-webkit-background-clip: text;
				background-clip: text;
				color: transparent;
			}

			.performance-message {
				font-size: 1.3em;
				margin: 20px 0;
				color: var(--text-medium);
				font-weight: 500;
			}

			.results-breakdown {
				background: var(--bg-light);
				border-radius: var(--border-radius-inner);
				padding: 25px;
				margin: 25px 0;
				text-align: left;
			}
			.results-breakdown h3 {
				color: var(--text-dark);
				margin-bottom: 15px;
				text-align: center;
			}

			.breakdown-item {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 10px 0;
				border-bottom: 1px solid #e9ecef;
			}
			.breakdown-item:last-child {
				border-bottom: none;
			}

			.breakdown-status {
				font-weight: 600;
				padding: 4px 12px;
				border-radius: 20px;
				font-size: 0.9em;
			}
			.breakdown-correct {
				background-color: #d4edda;
				color: #155724;
			}
			.breakdown-incorrect {
				background-color: #f8d7da;
				color: #721c24;
			}

			.review-item {
				margin-bottom: 20px;
				padding: 15px;
				border-radius: 8px;
				background: linear-gradient(145deg, var(--bg-white), var(--bg-light));
				border-left: 4px solid #e74c3c;
			}
			.review-bias-type {
				font-weight: 700;
				color: #e74c3c;
				font-size: 1.1em;
				margin-bottom: 8px;
				display: flex;
				align-items: center;
				gap: 8px;
			}
			.review-question {
				font-style: italic;
				color: var(--text-medium);
				line-height: 1.5;
				margin: 0;
				padding: 10px;
				background: var(--bg-light);
				border-radius: 6px;
				border: 1px solid var(--border-color);
			}

			/* --- Bias Reference Guide --- */
			.bias-category h4 {
				margin-bottom: 10px;
				padding-bottom: 5px;
				border-bottom: 2px solid var(--border-color);
			}
			.bias-item {
				background: var(--bg-white);
				padding: 10px;
				border-radius: 6px;
				border: 1px solid #e9ecef;
				margin-bottom: 10px;
			}

			/* --- Accessibility & Utility --- */
			.visually-hidden {
				position: absolute;
				width: 1px;
				height: 1px;
				padding: 0;
				margin: -1px;
				overflow: hidden;
				clip: rect(0, 0, 0, 0);
				white-space: nowrap;
				border: 0;
			}
			button:focus-visible {
				outline: 3px solid #4facfe;
				outline-offset: 2px;
			}
			.loading {
				display: inline-block;
				width: 20px;
				height: 20px;
				border: 3px solid rgba(255, 255, 255, 0.3);
				border-top-color: var(--bg-white);
				border-radius: 50%;
				animation: spin 1s linear infinite;
				margin-left: 10px;
			}
			@keyframes spin {
				to {
					transform: rotate(360deg);
				}
			}

			/* --- Print Styles for PDF Download --- */
			@media print {
				body {
					background: none;
					color: #000;
					padding: 0;
				}
				.no-print {
					display: none !important;
				}
				#quiz-container {
					box-shadow: none;
					border-radius: 0;
					padding: 0;
					max-width: 100%;
				}
				#question-screen {
					display: none;
				}
				#results-container {
					display: block !important;
					opacity: 1 !important;
					animation: none !important;
				}
				.score-display {
					-webkit-text-fill-color: initial;
					background: none;
					color: #000;
				}
				.results-breakdown,
				.review-item {
					background: #fff;
					border: 1px solid #ccc;
				}
				.breakdown-correct,
				.breakdown-incorrect {
					border: 1px solid #ccc;
					color: #000;
					background: #eee;
				}
				h2,
				h3 {
					page-break-after: avoid;
				}
				.review-item,
				.breakdown-item {
					page-break-inside: avoid;
				}
			}
		</style>
	</head>
	<body>
		<div id="quiz-container">
			<div id="question-screen" role="main">
				<div class="progress-container no-print" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
					<div class="progress-bar" id="progress-bar"></div>
				</div>
				<p class="progress-text no-print" id="progress-text">Question 1 of ?</p>

				<h1 id="question-header" class="question-header">Survey Question Bias Identification</h1>

				<div class="question-pair">
					<div class="question-box biased">
						<h3>❌ Questionnaire A (Biased)</h3>
						<p id="question-a" role="text"></p>
					</div>
					<div class="question-box improved">
						<h3>✅ Questionnaire B (Improved)</h3>
						<p id="question-b" role="text"></p>
					</div>
				</div>

				<div class="quiz-question">
					<span id="bias-question">Which bias is present in Question A?</span>
				</div>

				<div id="options-container" role="group" aria-labelledby="bias-question"></div>

				<div id="feedback-container" class="hidden" role="alert" aria-live="polite"></div>

				<button id="next-btn" class="hidden no-print">
					<span>Next Question</span>
					<span class="visually-hidden">- Continue to question <span id="next-question-number">2</span></span>
				</button>
			</div>

			<div id="results-container" class="hidden" role="main">
				<h2>🎉 Quiz Complete!</h2>
				<div class="score-display" id="score-display" role="text" aria-label="Final score">0/8</div>
				<p class="performance-message" id="performance-message"></p>

				<div class="results-breakdown" id="results-breakdown">
					<h3>📊 Detailed Results</h3>
					<div id="breakdown-list"></div>
				</div>

				<div class="results-breakdown" id="question-review">
					<h3>📚 Question Review - All Biased Examples</h3>
					<div id="question-review-list"></div>
				</div>

				<div class="results-breakdown" id="bias-reference">
					<h3>📖 Survey Bias Reference Guide</h3>
					<div id="bias-reference-list">
						<!-- This will be populated by JavaScript -->
					</div>
				</div>

				<button id="download-btn" class="no-print">
					<span>📄 Download Results as PDF</span>
				</button>

				<button id="restart-btn" class="no-print">
					<span>🔄 Take Quiz Again</span>
				</button>
			</div>
		</div>

		<script>
			// --- Single Source of Truth for Bias Definitions ---
			const BIAS_DEFINITIONS = {
				"Question Design": {
					"Ambiguous Question":
						"Questions that can be interpreted in multiple ways.",
					"Complex Question":
						"Questions with confusing structure or double negations.",
					"Double-Barrelled Question": "Two questions asked as one.",
					"Technical Jargon":
						"Using specialized or overly complex language.",
					"Vague Word":
						"Terms that mean different things to different people.",
				},
				"Missing or Inadequate Data": {
					"Belief vs Behavior":
						"Asking about hypothetical rather than actual behavior.",
					"Starting Time":
						"Inconsistent time frames affecting comparability.",
				},
				"Faulty Scale": {
					"Forced Choice": "Insufficient or unbalanced response categories.",
				},
				"Leading Questions": {
					Framing: "Presenting biased context before the question.",
					"Leading Question":
						"Questions that push toward a particular answer.",
				},
				Intrusiveness: {
					"Sensitive Question":
						"Questions about private or socially sensitive topics.",
				},
			};

			const FULL_QUIZ_DATA = [
				{
					questionA:
						"How often do you exercise: never, rarely, sometimes, or frequently?",
					questionB:
						"How many times per week do you engage in physical exercise for at least 30 minutes? (e.g., 0, 1-2, 3-4, 5+)",
					options: ["Complex Question", "Vague Word", "Ambiguous Question"],
					correctAnswer: "Vague Word",
					explanation:
						"Question A uses <strong>vague words</strong> like 'rarely' and 'frequently' that are subjective. Question B provides specific, measurable categories.",
				},
				{
					questionA:
						"Do you support the new bill that will increase taxes but provide universal coverage?",
					questionB: "Do you support or oppose the new healthcare reform bill?",
					options: [
						"Leading Question",
						"Technical Jargon",
						"Double-Barrelled Question",
					],
					correctAnswer: "Double-Barrelled Question",
					explanation:
						"Question A is a <strong>double-barrelled question</strong> because it asks about two separate issues (tax increases AND universal coverage). These should be asked separately.",
				},
				{
					questionA:
						"Given that crime rates have been rising, do you think we need more police officers?",
					questionB: "Do you think your community needs more police officers?",
					options: ["Framing", "Sensitive Question", "Forced Choice"],
					correctAnswer: "Framing",
					explanation:
						"Question A uses <strong>framing</strong> by presenting a biased premise ('crime rates have been rising') to influence the response. Question B asks directly without the leading context.",
				},
				{
					questionA:
						"Rate your satisfaction with our customer service: Excellent, Good, or Average.",
					questionB:
						"Rate your satisfaction with our customer service: Very Satisfied, Satisfied, Neutral, Dissatisfied, Very Dissatisfied.",
					options: ["Vague Word", "Leading Question", "Forced Choice"],
					correctAnswer: "Forced Choice",
					explanation:
						"Question A demonstrates <strong>forced choice</strong> by providing an unbalanced scale with no negative options. Question B provides a complete, balanced scale.",
				},
				{
					questionA:
						"Does it seem possible to you that the Nazi extermination of the Jews never happened, or do you feel certain that it happened?",
					questionB:
						"Do you believe the Holocaust (the Nazi extermination of the Jews) happened?",
					options: [
						"Sensitive Question",
						"Double-Barrelled Question",
						"Complex Question",
					],
					correctAnswer: "Complex Question",
					explanation:
						"Question A is a <strong>complex question</strong> due to its confusing double-negative structure ('possible...never happened'), making it difficult to understand. Question B is direct and clear.",
				},
				{
					questionA: "Do you practice safe sex?",
					questionB: "Do you own a car?",
					options: ["Leading Question", "Vague Word", "Sensitive Question"],
					correctAnswer: "Sensitive Question",
					explanation:
						"Question A is a <strong>sensitive question</strong> about private behavior, where social pressure can lead to dishonest answers. Question B is neutral and factual.",
				},
				{
					questionA:
						"How frequently do you utilize social media platforms for interpersonal communication purposes?",
					questionB:
						"How often do you use social media to communicate with others?",
					options: [
						"Technical Jargon",
						"Ambiguous Question",
						"Complex Question",
					],
					correctAnswer: "Technical Jargon",
					explanation:
						"Question A uses <strong>technical jargon</strong> ('utilize,' 'interpersonal communication') that can be confusing. Question B uses simple, clear language.",
				},
				{
					questionA: "Do you regularly engage in physical activity?",
					questionB:
						"In the past 7 days, on how many days did you exercise for at least 30 minutes?",
					options: ["Belief vs Behavior", "Vague Word", "Ambiguous Question"],
					correctAnswer: "Ambiguous Question",
					explanation:
						"Question A is <strong>ambiguous</strong> because 'regularly' and 'physical activity' are not clearly defined. Question B provides a specific time frame and duration, removing ambiguity.",
				},
			];

			class SurveyBiasQuiz {
				constructor(quizData) {
					this.fullQuizData = quizData;
					this.totalQuestions = this.getQuestionCountFromURL();
					this.quizData = this.sampleQuestions(
						this.fullQuizData,
						this.totalQuestions
					);

					this.currentQuestionIndex = 0;
					this.score = 0;
					this.userAnswers = [];
					this.elements = this.getElements();

					this.bindEvents();
					this.renderBiasReference();
					this.startQuiz();
				}

				getQuestionCountFromURL() {
					const urlParams = new URLSearchParams(window.location.search);
					const questionCount = parseInt(urlParams.get("questions"), 10);
					const maxQuestions = this.fullQuizData.length;

					if (questionCount > 0 && questionCount <= maxQuestions) {
						return questionCount;
					}
					// Default to 8 questions if no valid parameter is specified
					return 8;
				}

				sampleQuestions(questions, count) {
					const shuffled = [...questions].sort(() => 0.5 - Math.random());
					return shuffled.slice(0, count);
				}

				getElements() {
					const elementIds = [
						"question-screen", "results-container", "question-header",
						"question-a", "question-b", "options-container", "feedback-container",
						"next-btn", "next-question-number", "progress-bar", "progress-text",
						"score-display", "performance-message", "breakdown-list",
						"question-review-list", "download-btn", "restart-btn", "bias-reference-list"
					];
					const elements = {};
					for (const id of elementIds) {
						const key = id.replace(/-./g, (m) => m[1].toUpperCase()); // kebab-case to camelCase
						elements[key] = document.getElementById(id);
						if (!elements[key]) {
							console.error(`Initialization Error: Element with ID #${id} not found.`);
						}
					}
					return elements;
				}

				bindEvents() {
					this.elements.nextBtn.addEventListener("click", () => this.nextQuestion());
					this.elements.restartBtn.addEventListener("click", () => this.restartQuiz());
					this.elements.downloadBtn.addEventListener("click", () => this.downloadResults());
				}

				startQuiz() {
					this.currentQuestionIndex = 0;
					this.score = 0;
					this.userAnswers = [];
					this.elements.questionScreen.classList.remove("hidden");
					this.elements.resultsContainer.classList.add("hidden");
					this.showQuestion();
				}

				showQuestion() {
					this.elements.feedbackContainer.classList.add("hidden");
					this.elements.nextBtn.classList.add("hidden");

					const currentQuestion = this.quizData[this.currentQuestionIndex];
					const total = this.quizData.length;
					const currentNum = this.currentQuestionIndex + 1;

					const progressPercent = (this.currentQuestionIndex / total) * 100;
					this.elements.progressBar.style.width = `${progressPercent}%`;
					this.elements.progressText.textContent = `Question ${currentNum} of ${total}`;

					this.elements.questionHeader.textContent = `Question Pair ${currentNum}`;
					this.elements.questionA.textContent = currentQuestion.questionA;
					this.elements.questionB.textContent = currentQuestion.questionB;

					this.elements.nextBtn.firstElementChild.textContent =
						this.currentQuestionIndex < total - 1 ? "Next Question" : "View Results";

					this.renderOptions(currentQuestion);
				}

				renderOptions(question) {
					this.elements.optionsContainer.innerHTML = "";
					question.options.forEach((option) => {
						const button = document.createElement("button");
						button.textContent = option;
						button.className = "option-btn";
						button.onclick = () => this.selectAnswer(button, option, question);
						this.elements.optionsContainer.appendChild(button);
					});
				}

				selectAnswer(button, selectedOption, question) {
					const isCorrect = selectedOption === question.correctAnswer;
					this.userAnswers.push({ isCorrect });

					if (isCorrect) {
						this.score++;
						button.classList.add("correct");
						this.showFeedback(true, question.explanation);
					} else {
						button.classList.add("incorrect");
						this.showFeedback(false, question.explanation, question.correctAnswer);
						this.highlightCorrectAnswer(question.correctAnswer);
					}

					this.disableAllOptions();
					this.elements.nextBtn.classList.remove("hidden");
					this.elements.nextBtn.focus();
				}

				showFeedback(isCorrect, explanation, correctAnswer = null) {
					const container = this.elements.feedbackContainer;
					let feedbackHTML = isCorrect
						? `<strong>🎉 Correct!</strong><br><br>${explanation}`
						: `<strong>❌ Not quite.</strong> The best answer is <strong>${correctAnswer}</strong>.<br><br>${explanation}`;
					container.innerHTML = feedbackHTML;
					container.className = `show ${isCorrect ? "feedback-correct" : "feedback-incorrect"}`;
					container.classList.remove("hidden");
				}

				highlightCorrectAnswer(correctAnswer) {
					Array.from(this.elements.optionsContainer.children).forEach((btn) => {
						if (btn.textContent === correctAnswer) {
							btn.classList.add("correct");
						}
					});
				}

				disableAllOptions() {
					Array.from(this.elements.optionsContainer.children).forEach((btn) => {
						btn.disabled = true;
					});
				}

				nextQuestion() {
					this.currentQuestionIndex++;
					if (this.currentQuestionIndex < this.quizData.length) {
						this.showQuestion();
					} else {
						this.showResults();
					}
				}

				showResults() {
					this.elements.questionScreen.classList.add("hidden");
					this.elements.resultsContainer.classList.remove("hidden");

					const total = this.quizData.length;
					const percentage = Math.round((this.score / total) * 100);

					this.elements.scoreDisplay.textContent = `${this.score}/${total}`;
					this.elements.performanceMessage.textContent = this.getPerformanceMessage(percentage);
					this.showResultsBreakdown();
					this.showQuestionReview();

					this.elements.progressBar.style.width = "100%";
				}

				getPerformanceMessage(percentage) {
					if (percentage >= 90) return "🌟 Outstanding! You're a survey bias expert!";
					if (percentage >= 70) return "🎯 Excellent work! You have a great eye for detail.";
					if (percentage >= 50) return "👍 Good job! You identified most biases correctly.";
					return "🤔 This is tricky stuff! Review the guide and try again.";
				}

				showResultsBreakdown() {
					this.elements.breakdownList.innerHTML = this.userAnswers
						.map((answer, index) => `
							<div class="breakdown-item">
								<span>Question ${index + 1}</span>
								<span class="breakdown-status ${answer.isCorrect ? "breakdown-correct" : "breakdown-incorrect"}">
									${answer.isCorrect ? "✓ Correct" : "✗ Incorrect"}
								</span>
							</div>`
						).join("");
				}

				showQuestionReview() {
					this.elements.questionReviewList.innerHTML = this.quizData
						.map((q, index) => `
							<div class="review-item">
								<div class="review-bias-type">
									<span>❌</span>
									<span>Question ${index + 1}: ${q.correctAnswer}</span>
								</div>
								<p class="review-question">"${q.questionA}"</p>
							</div>`
						).join("");
				}

				renderBiasReference() {
					this.elements.biasReferenceList.innerHTML = Object.entries(BIAS_DEFINITIONS)
						.map(([category, biases]) => `
								<div class="bias-category">
									<h4>${category}</h4>
									${Object.entries(biases)
										.map(([name, definition]) => `<div class="bias-item"><strong>${name}:</strong> ${definition}</div>`)
										.join("")}
								</div>`
						).join("");
				}

				restartQuiz() {
					this.elements.restartBtn.innerHTML = '<span>🔄 Restarting...</span><span class="loading"></span>';
					setTimeout(() => {
						this.elements.restartBtn.innerHTML = "<span>🔄 Take Quiz Again</span>";
						this.quizData = this.sampleQuestions(this.fullQuizData, this.totalQuestions);
						this.startQuiz();
					}, 500);
				}

				downloadResults() {
					const originalTitle = document.title;
					document.title = `Survey Bias Quiz Results - Score ${this.score} of ${this.quizData.length}`;
					window.print();
					document.title = originalTitle;
				}
			}

			document.addEventListener("DOMContentLoaded", () => {
				new SurveyBiasQuiz(FULL_QUIZ_DATA);
			});
		</script>
	</body>
</html>